appId: com.duckduckgo.mobile.ios
tags:
    - sync

---

# Clear and launch
- clearState
- launchApp

# Run onboarding Flow
- runFlow: 
    when: 
      visible: 
        text: "Let’s Do It!"
        index: 0
    file: ../shared/onboarding.yaml

# Add local favorite and bookmark
- runFlow:
    file: ../shared/add_bookmarks_and_favorites.yaml

# Add local login
- tapOn: Browsing Menu
- tapOn: Settings
- runFlow:
    file: ../shared/add_login_from_settings.yaml

#  Copy Recovery Code
- tapOn: Browsing Menu
- tapOn: Settings
- runFlow:
    file: ../shared/copy_recovery_code_from_settings.yaml
    env:
        CODE: ${CODE}

# Set Internal User
- runFlow:
    file: ../shared/set_internal_user.yaml

# Login
- assertVisible: Sync & Backup
- tapOn: Sync & Backup
- runFlow:
    file: ../shared/sync_login.yaml
- assertVisible: Sync & Backup

# Verify bookmarks have been merged
- runFlow:
    file: ../shared/sync_verify_bookmarks.yaml

# Only expect local favorites when Share Favorites is off
- tapOn: Favorites
- assertVisible: DuckDuckGo — Privacy, simplified.
- tapOn: Done
- tapOn: Browsing Menu
- tapOn: Settings

# Enable Share Favorites and expect all favorites
- runFlow:
    file: ../shared/sync_verify_unified_favorites.yaml

# Verify logins
- tapOn: Browsing Menu
- tapOn: Settings
- runFlow:
    file: ../shared/sync_verify_logins.yaml

# Log Out
- tapOn: Sync & Backup
- runFlow:
    file: ../shared/sync_logout.yaml
- tapOn: Settings
- tapOn: Done

# Remove bookmarks that were added locally
- runFlow:
    file: ../shared/remove_local_bookmarks.yaml

# Remove Login that were added locally
- runFlow:
    file: ../shared/remove_local_logins.yaml

# Login
- tapOn: Browsing Menu
- tapOn: Settings
- tapOn: Sync & Backup
- runFlow:
    file: ../shared/sync_login.yaml

# Verify bookmarks have been merged
- tapOn: Settings
- runFlow:
    file: ../shared/sync_verify_bookmarks.yaml

# Verify favorites are unified
- tapOn: Favorites
- assertVisible: NFL.com | Official Site of the National Football League
- assertVisible: DuckDuckGo · GitHub
- assertVisible: Stack Overflow - Where Developers Learn, Share, & Build Careers
- tapOn: Done
- tapOn: Browsing Menu
- tapOn: Settings

# Verify logins
- runFlow:
    file: ../shared/sync_verify_logins.yaml

  # Clean up
- tapOn: Sync & Backup
- runFlow:
    file: ../shared/sync_delete.yaml
